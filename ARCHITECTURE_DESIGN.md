# ä¸ªæ€§åŒ–å¥åº·è¯„ä¼°ç³»ç»Ÿ - æ¶æ„è®¾è®¡æ–‡æ¡£

## ğŸ“ ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å‰ç«¯å±‚ (Flutter/Web)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ä¸ªæ€§åŒ–å¥åº·æ¡£æ¡ˆç¼–è¾‘ â†’ å¥åº·åˆ†æå±•ç¤º â†’ ä¸ªæ€§åŒ–å»ºè®®           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ HTTP/REST API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  åç«¯APIå±‚ (Express.js)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  /api/health-profile                                      â”‚  â”‚
â”‚  â”‚  - GET/POST/DELETE - æ¡£æ¡ˆç®¡ç†                            â”‚  â”‚
â”‚  â”‚  - /standards - ä¸ªæ€§åŒ–æ ‡å‡†                               â”‚  â”‚
â”‚  â”‚  - /analysis/personalized - ä¸ªæ€§åŒ–åˆ†æ                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ SQL Queries
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ•°æ®å±‚ (MySQL)                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  users                                                    â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ user_health_profiles (ä¸ªæ€§åŒ–æ¡£æ¡ˆ)                    â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ health_standards_reference (æ ‡å‡†å‚è€ƒ)                â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ health_records (å¥åº·æ•°æ®)                            â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ user_goals (ç”¨æˆ·ç›®æ ‡)                                â”‚  â”‚
â”‚  â”‚  â””â”€â”€ v_user_personalized_standards (ä¸ªæ€§åŒ–æ ‡å‡†è§†å›¾)        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ æ ¸å¿ƒå·¥ä½œæµ

### 1. ç”¨æˆ·æ¡£æ¡ˆåˆ›å»ºæµç¨‹

```
ç”¨æˆ·æ³¨å†Œ
  â†“
è‡ªåŠ¨è®¡ç®—å¹´é¾„ç»„
  â†“
åˆ›å»º user_health_profiles è®°å½•
  â”œâ”€ age_group: æ ¹æ® birthday è®¡ç®—
  â”œâ”€ activity_level: é»˜è®¤ 'moderately_active'
  â”œâ”€ health_condition: é»˜è®¤ 'good'
  â””â”€ å…¶ä»–ç‰¹æ®Šæ¡ä»¶: é»˜è®¤ false
  â†“
ç”¨æˆ·å¯ç¼–è¾‘æ¡£æ¡ˆ
  â”œâ”€ ä¿®æ”¹è¿åŠ¨æ°´å¹³
  â”œâ”€ æ ‡è®°ç‰¹æ®Šæ¡ä»¶
  â””â”€ æ·»åŠ åŒ»ç”Ÿå»ºè®®
  â†“
æ¡£æ¡ˆä¿å­˜å®Œæˆ
```

### 2. ä¸ªæ€§åŒ–æ ‡å‡†åŒ¹é…æµç¨‹

```
æŸ¥è¯¢ user_health_profiles
  â†“
è·å–: age_group, gender, activity_level
  â†“
ä» health_standards_reference æŸ¥è¯¢åŒ¹é…çš„æ ‡å‡†
  SELECT * FROM health_standards_reference
  WHERE age_group = ? 
    AND (gender = ? OR gender = 'all')
    AND activity_level = ?
  â†“
è¿”å›è¯¥ç»„åˆçš„æ‰€æœ‰æ ‡å‡†å‚æ•°
  â”œâ”€ daily_steps_min/optimal/max
  â”œâ”€ resting_heart_rate_min/normal/max
  â”œâ”€ sleep_min/optimal/max
  â”œâ”€ blood_pressure_systolic/diastolic_normal
  â”œâ”€ bmi_optimal_min/max
  â””â”€ water_intake_daily_ml
  â†“
å¦‚æœ‰ personalized_* å­—æ®µï¼Œåˆ™è¦†ç›–é»˜è®¤å€¼
  â†“
æ ‡å‡†åº”ç”¨å®Œæˆ
```

### 3. å¥åº·åˆ†ææµç¨‹

```
ç”¨æˆ·è¯·æ±‚åˆ†æ
  â†“
è·å–ç”¨æˆ·æ¡£æ¡ˆ
  â”œâ”€ æŸ¥è¯¢ user_health_profiles
  â”œâ”€ è®¡ç®—ä¸ªæ€§åŒ–æ ‡å‡†
  â””â”€ è·å–ç‰¹æ®Šæ¡ä»¶æ ‡è®°
  â†“
è·å–æœ€æ–°å¥åº·æ•°æ®
  â”œâ”€ æœ€æ–°ä½“é‡
  â”œâ”€ æœ€æ–°æ­¥æ•°
  â”œâ”€ æœ€æ–°å¿ƒç‡
  â”œâ”€ æœ€æ–°è¡€å‹
  â”œâ”€ æœ€æ–°ç¡çœ 
  â””â”€ å…¶ä»–æŒ‡æ ‡
  â†“
æ‰§è¡Œå¤šç»´åº¦è¯„ä¼°
  â”œâ”€ BMIè¯„ä¼° â†’ getPersonalizedBMICategory()
  â”œâ”€ æ­¥æ•°è¯„ä¼° â†’ getPersonalizedStepsAssessment()
  â”œâ”€ å¿ƒç‡è¯„ä¼° â†’ getPersonalizedHeartRateAssessment()
  â”œâ”€ ç¡çœ è¯„ä¼° â†’ getPersonalizedSleepAssessment()
  â””â”€ è¡€å‹è¯„ä¼° â†’ getPersonalizedBloodPressureAssessment()
  â†“
è®¡ç®—ä¸ªæ€§åŒ–å¥åº·è¯„åˆ†
  â”œâ”€ åŸºç¡€åˆ†: 60åˆ†
  â”œâ”€ BMIè¯„åˆ†: +0-20
  â”œâ”€ æ­¥æ•°è¯„åˆ†: +0-20
  â”œâ”€ ç¡çœ è¯„åˆ†: +0-15
  â”œâ”€ å¿ƒç‡è¯„åˆ†: +0-15
  â”œâ”€ è¡€å‹è¯„åˆ†: +0-15
  â””â”€ ç‰¹æ®Šæ¡ä»¶æ‰£åˆ†: -5-10
  â†“
ç”Ÿæˆä¸ªæ€§åŒ–å»ºè®®
  â”œâ”€ ä¼˜å…ˆçº§æ’åº: high â†’ medium â†’ low
  â”œâ”€ åŸºäºè¯„ä¼°ç»“æœ
  â”œâ”€ åŸºäºç‰¹æ®Šæ¡ä»¶
  â””â”€ å¯å«åŒ»ç”Ÿå»ºè®®
  â†“
è¿”å›å®Œæ•´åˆ†ææŠ¥å‘Š
```

---

## ğŸ“¦ æ ¸å¿ƒæ•°æ®ç»“æ„

### user_health_profiles è¡¨

```sql
CREATE TABLE user_health_profiles (
  id VARCHAR(36) PRIMARY KEY,          -- UUID
  user_id VARCHAR(36) UNIQUE,          -- å…³è”ç”¨æˆ·
  
  -- åŸºç¡€ç‰¹å¾
  age_group ENUM(...),                 -- å¹´é¾„æ®µ
  activity_level ENUM(...),            -- è¿åŠ¨æ°´å¹³
  health_condition ENUM(...),          -- å¥åº·çŠ¶å†µ
  
  -- ç‰¹æ®Šæ¡ä»¶æ ‡è®° (0/1)
  has_cardiovascular_issues,           -- å¿ƒè¡€ç®¡é—®é¢˜
  has_diabetes,                        -- ç³–å°¿ç—…
  has_joint_issues,                    -- å…³èŠ‚é—®é¢˜
  is_pregnant,                         -- å­•æœŸ
  is_recovering,                       -- åº·å¤æœŸ
  
  -- ä¸ªæ€§åŒ–ç›®æ ‡ï¼ˆå¯é€‰è¦†ç›–é»˜è®¤å€¼ï¼‰
  personalized_steps_goal,             -- ä¸ªæ€§åŒ–æ­¥æ•°ç›®æ ‡
  personalized_heart_rate_min,         -- ä¸ªæ€§åŒ–å¿ƒç‡æœ€å°å€¼
  personalized_heart_rate_max,         -- ä¸ªæ€§åŒ–å¿ƒç‡æœ€å¤§å€¼
  personalized_sleep_goal,             -- ä¸ªæ€§åŒ–ç¡çœ ç›®æ ‡
  personalized_water_goal,             -- ä¸ªæ€§åŒ–é¥®æ°´ç›®æ ‡
  
  -- åŒ»ç–—ä¿¡æ¯
  doctor_notes TEXT,                   -- åŒ»ç”Ÿå»ºè®®
  
  created_at, updated_at               -- æ—¶é—´æˆ³
);
```

### health_standards_reference è¡¨

```sql
CREATE TABLE health_standards_reference (
  id VARCHAR(36) PRIMARY KEY,
  
  -- äººç¾¤æ ‡ç­¾ï¼ˆå”¯ä¸€æ€§çº¦æŸï¼‰
  age_group ENUM(...),                 -- å¹´é¾„æ®µ
  gender ENUM('male', 'female', 'all'), -- æ€§åˆ«
  activity_level ENUM(...),            -- è¿åŠ¨æ°´å¹³
  
  -- æ­¥æ•°æ ‡å‡†
  daily_steps_min,                     -- æœ€ä½
  daily_steps_optimal,                 -- æœ€ä¼˜
  daily_steps_max,                     -- æœ€é«˜
  
  -- å¿ƒç‡æ ‡å‡† (bpm)
  resting_heart_rate_min,              -- é™æ¯å¿ƒç‡æœ€å°
  resting_heart_rate_normal,           -- é™æ¯å¿ƒç‡æ­£å¸¸ä¸Šé™
  max_heart_rate,                      -- æœ€å¤§å¿ƒç‡
  
  -- ç¡çœ æ ‡å‡† (å°æ—¶)
  sleep_min, sleep_optimal, sleep_max,
  
  -- è¡€å‹æ ‡å‡† (mmHg)
  blood_pressure_systolic_normal,      -- æ”¶ç¼©å‹
  blood_pressure_diastolic_normal,     -- èˆ’å¼ å‹
  
  -- BMIæ ‡å‡†
  bmi_min, bmi_optimal_min, bmi_optimal_max, bmi_max,
  
  -- é¥®æ°´æ ‡å‡† (ml)
  water_intake_daily_ml,
  
  notes TEXT                           -- è¯´æ˜æ–‡å­—
);
```

### è§†å›¾ï¼šv_user_personalized_standards

```sql
SELECT 
  u.id AS user_id,
  u.username,
  u.gender,
  YEAR(CURDATE()) - YEAR(u.birthday) AS age,
  hp.age_group,
  hp.activity_level,
  hp.health_condition,
  
  -- åˆå¹¶ä¸ªæ€§åŒ–å’Œé»˜è®¤æ ‡å‡†
  COALESCE(hp.personalized_steps_goal, hsr.daily_steps_optimal) 
    AS recommended_daily_steps,
  COALESCE(hp.personalized_heart_rate_min, hsr.resting_heart_rate_min)
    AS recommended_heart_rate_min,
  -- ... å…¶ä»–å­—æ®µ
  
  hp.doctor_notes,
  hp.updated_at
FROM users u
LEFT JOIN user_health_profiles hp ON u.id = hp.user_id
LEFT JOIN health_standards_reference hsr ON 
  hp.age_group = hsr.age_group AND 
  (hsr.gender = u.gender OR hsr.gender = 'all') AND
  hp.activity_level = hsr.activity_level
WHERE u.deleted_at IS NULL;
```

---

## ğŸ”Œ API è®¾è®¡

### èµ„æºå»ºæ¨¡

```
/api/health-profile
â”œâ”€ åŸºæœ¬æ“ä½œ (CRUD)
â”‚  â”œâ”€ GET / - è·å–æ¡£æ¡ˆ
â”‚  â”œâ”€ POST / - åˆ›å»º/æ›´æ–°
â”‚  â”œâ”€ DELETE / - åˆ é™¤
â”‚  â””â”€ PUT /doctor-notes - æ›´æ–°åŒ»ç”Ÿå»ºè®®
â”œâ”€ æ ‡å‡†æŸ¥è¯¢
â”‚  â””â”€ GET /standards - è·å–ä¸ªæ€§åŒ–æ ‡å‡†
â””â”€ åˆ†ææŸ¥è¯¢
   â””â”€ GET /analysis/personalized - ä¸ªæ€§åŒ–åˆ†ææŠ¥å‘Š
```

### è¯·æ±‚/å“åº”ç»“æ„

#### è·å–æ¡£æ¡ˆ - GET /

```json
// è¯·æ±‚
GET /api/health-profile
Authorization: Bearer <token>

// å“åº” 200
{
  "success": true,
  "data": {
    "id": "uuid",
    "user_id": "uuid",
    "age_group": "adult",
    "activity_level": "moderately_active",
    "health_condition": "good",
    "has_cardiovascular_issues": false,
    "has_diabetes": false,
    "has_joint_issues": false,
    "is_pregnant": false,
    "is_recovering": false,
    "personalized_steps_goal": null,
    "personalized_heart_rate_min": null,
    "personalized_heart_rate_max": null,
    "personalized_sleep_goal": null,
    "personalized_water_goal": null,
    "doctor_notes": null,
    "created_at": "2026-01-05T10:00:00.000Z",
    "updated_at": "2026-01-05T10:00:00.000Z"
  }
}
```

#### åˆ›å»º/æ›´æ–°æ¡£æ¡ˆ - POST /

```json
// è¯·æ±‚
POST /api/health-profile
Authorization: Bearer <token>
Content-Type: application/json

{
  "ageGroup": "adult",
  "activityLevel": "moderately_active",
  "healthCondition": "good",
  "hasCardiovascularIssues": false,
  "hasDiabetes": false,
  "hasJointIssues": false,
  "isPregnant": false,
  "isRecovering": false,
  "personalizedStepsGoal": null,
  "personalizedHeartRateMin": null,
  "personalizedHeartRateMax": null,
  "personalizedSleepGoal": null,
  "personalizedWaterGoal": null,
  "doctorNotes": null
}

// å“åº” 200
{
  "success": true,
  "message": "å¥åº·æ¡£æ¡ˆåˆ›å»ºæˆåŠŸ",
  "data": { ... }
}
```

#### è·å–ä¸ªæ€§åŒ–æ ‡å‡† - GET /standards

```json
// è¯·æ±‚
GET /api/health-profile/standards
Authorization: Bearer <token>

// å“åº” 200
{
  "success": true,
  "data": {
    "user_id": "uuid",
    "age_group": "adult",
    "activity_level": "moderately_active",
    "recommended_daily_steps": 10000,
    "recommended_heart_rate_min": 60,
    "recommended_heart_rate_max": 80,
    "recommended_sleep_hours": 8,
    "recommended_water_ml": 2500,
    "bmi_optimal_range": "18.5-24",
    "blood_pressure_normal": "120/80 mmHg",
    "doctor_notes": null,
    "updated_at": "2026-01-05T10:00:00.000Z"
  }
}
```

#### è·å–ä¸ªæ€§åŒ–åˆ†æ - GET /analysis/personalized

```json
// è¯·æ±‚
GET /api/health-profile/analysis/personalized
Authorization: Bearer <token>

// å“åº” 200
{
  "success": true,
  "data": {
    "userInfo": { ... },
    "personalizationFactors": { ... },
    "currentStatus": { ... },
    "assessments": {
      "bmi": { ... },
      "steps": { ... },
      "heartRate": { ... },
      "sleep": { ... },
      "bloodPressure": { ... }
    },
    "healthScore": 82,
    "recommendations": [
      {
        "category": "è¿åŠ¨å»ºè®®",
        "priority": "medium",
        "advice": "..."
      }
    ],
    "personalizedStandards": { ... },
    "analyzedAt": "2026-01-05T10:15:00.000Z"
  }
}
```

---

## ğŸ§® è¯„åˆ†ç®—æ³•

### å¥åº·åˆ†æ•°è®¡ç®—

```
åŸºç¡€åˆ†: 60

+ BMIè¯„åˆ† (æœ€å¤š20åˆ†)
  â”œâ”€ æ­£å¸¸ (18.5-24): +20
  â”œâ”€ åç˜¦/åèƒ– (Â±5): +10
  â””â”€ è‚¥èƒ–: +0

+ æ­¥æ•°è¯„åˆ† (æœ€å¤š20åˆ†)
  â”œâ”€ è¾¾åˆ°æœ€ä¼˜: +20
  â”œâ”€ è¾¾åˆ°70%: +10
  â”œâ”€ è¾¾åˆ°50%: +5
  â””â”€ ä½äº50%: +0

+ ç¡çœ è¯„åˆ† (æœ€å¤š15åˆ†)
  â”œâ”€ 7-9å°æ—¶: +15
  â”œâ”€ 6-10å°æ—¶: +5
  â””â”€ å…¶ä»–: +0

+ å¿ƒç‡è¯„åˆ† (æœ€å¤š15åˆ†)
  â”œâ”€ æ­£å¸¸èŒƒå›´: +15
  â”œâ”€ ç•¥é«˜/ç•¥ä½: +5
  â””â”€ å¼‚å¸¸: +0

+ è¡€å‹è¯„åˆ† (æœ€å¤š15åˆ†)
  â”œâ”€ æ­£å¸¸: +15
  â”œâ”€ ç•¥é«˜: +5
  â””â”€ é«˜è¡€å‹: +0

- ç‰¹æ®Šæ¡ä»¶æ‰£åˆ†
  â”œâ”€ å¿ƒè¡€ç®¡é—®é¢˜: -10
  â”œâ”€ ç³–å°¿ç—…: -10
  â”œâ”€ å…³èŠ‚é—®é¢˜: -5
  â”œâ”€ å­•æœŸ: -5
  â””â”€ åº·å¤æœŸ: -5

æœ€ç»ˆåˆ†æ•° = æ€»åˆ†, èŒƒå›´ [0, 100]
```

### å»ºè®®ä¼˜å…ˆçº§

```
High (çº¢è‰²):
  - è¡€å‹å¼‚å¸¸
  - BMIä¸¥é‡è¶…æ ‡
  - æ­¥æ•°ä¸¥é‡ä¸è¶³
  - ç¡çœ ä¸è¶³
  - ç‰¹æ®Šæ¡ä»¶ç›¸å…³

Medium (æ©™è‰²):
  - æ­¥æ•°æ¥è¿‘ç›®æ ‡ä½†æœªè¾¾
  - æŒ‡æ ‡ç•¥å¾®å¼‚å¸¸
  - é¢„é˜²æ€§å»ºè®®

Low (ç»¿è‰²):
  - æŒ‡æ ‡æ­£å¸¸ï¼Œç»´æŒå»ºè®®
  - ä¼˜åŒ–å»ºè®®
  - é¼“åŠ±ä¿¡æ¯
```

---

## ğŸ” å®‰å…¨æ€§è€ƒè™‘

### è®¤è¯
```
æ‰€æœ‰ /api/health-profile æ¥å£éƒ½éœ€è¦:
- Authorization: Bearer <jwt_token>
- Token é€šè¿‡ /api/auth/login è·å¾—
```

### æˆæƒ
```
ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ¡£æ¡ˆå’Œæ•°æ®:
- è·å–æ¡£æ¡ˆ: æ£€æŸ¥ user_id == å½“å‰ç”¨æˆ·
- æ›´æ–°æ¡£æ¡ˆ: æ£€æŸ¥ user_id == å½“å‰ç”¨æˆ·
- åˆ é™¤æ¡£æ¡ˆ: æ£€æŸ¥ user_id == å½“å‰ç”¨æˆ·
```

### æ•°æ®éªŒè¯
```
POST /api/health-profile çš„éªŒè¯è§„åˆ™:
- ageGroup: å¿…é¡»åœ¨æšä¸¾å€¼ä¸­
- activityLevel: å¿…é¡»åœ¨æšä¸¾å€¼ä¸­
- healthCondition: å¿…é¡»åœ¨æšä¸¾å€¼ä¸­
- å¸ƒå°”å­—æ®µ: æ­£ç¡®çš„ç±»å‹æ£€æŸ¥
- æ•°å­—å­—æ®µ: èŒƒå›´æ£€æŸ¥
```

---

## ğŸƒ æ€§èƒ½ä¼˜åŒ–

### æ•°æ®åº“ä¼˜åŒ–
```sql
-- æ·»åŠ ç´¢å¼•
CREATE INDEX idx_user_health_profiles_user_id 
  ON user_health_profiles(user_id);

CREATE INDEX idx_health_standards_ref 
  ON health_standards_reference(age_group, gender, activity_level);

-- è§†å›¾å·²ä¼˜åŒ–ï¼Œä½¿ç”¨ LEFT JOIN
```

### æŸ¥è¯¢ä¼˜åŒ–
```javascript
// åˆå¹¶æŸ¥è¯¢ï¼Œå‡å°‘æ•°æ®åº“å¾€è¿”
const [profile, standards, records] = await Promise.all([
  getHealthProfile(userId),
  getPersonalizedStandards(userId),
  getLatestHealthRecords(userId)
]);
```

### ç¼“å­˜ç­–ç•¥
```
- ä¸ªæ€§åŒ–æ ‡å‡†: ç¼“å­˜1å°æ—¶ï¼ˆç”¨æˆ·æ¡£æ¡ˆä¸å¸¸æ”¹å˜ï¼‰
- å¥åº·åˆ†æ: ç¼“å­˜30åˆ†é’Ÿï¼ˆæ•°æ®æ›´æ–°ä¸é¢‘ç¹ï¼‰
- å¥åº·è®°å½•: ç¼“å­˜ä¸è¶…è¿‡5åˆ†é’Ÿï¼ˆéœ€è¦å®æ—¶æ€§ï¼‰
```

---

## ğŸ“Š å¯æ‰©å±•æ€§

### æ·»åŠ æ–°çš„äººç¾¤æ ‡å‡†

```sql
-- ç¤ºä¾‹ï¼šæ·»åŠ å„¿ç«¥æ ‡å‡†
INSERT INTO health_standards_reference (
  id, age_group, gender, activity_level,
  daily_steps_min, daily_steps_optimal, daily_steps_max,
  -- ... å…¶ä»–å­—æ®µ
) VALUES (
  UUID(), 'child', 'all', 'moderately_active',
  5000, 8000, 12000,
  -- ... å…¶ä»–å€¼
);
```

### æ·»åŠ æ–°çš„ç‰¹æ®Šæ¡ä»¶

```sql
-- ä¿®æ”¹ user_health_profiles è¡¨
ALTER TABLE user_health_profiles ADD COLUMN 
  has_hypertension TINYINT(1) DEFAULT 0 COMMENT 'é«˜è¡€å‹';

-- åœ¨åˆ†æä¸­å¤„ç†
if (profile.has_hypertension) {
  // ç‰¹æ®Šå»ºè®®
}
```

### æ·»åŠ æ–°çš„è¯„åˆ†æŒ‡æ ‡

```javascript
// ä¿®æ”¹ calculatePersonalizedHealthScore()
// æ·»åŠ æ–°æŒ‡æ ‡è¯„åˆ†é€»è¾‘
if (metabolicRate) {
  if (metabolicRate >= 1.0) score += 10;
}
```

---

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•
```
- calculatePersonalizedHealthScore()
- getPersonalizedBMICategory()
- å„ä¸ªè¯„ä¼°å‡½æ•°
- å¹´é¾„ç»„è®¡ç®—
```

### é›†æˆæµ‹è¯•
```
- å®Œæ•´çš„ API è¯·æ±‚æµç¨‹
- æ•°æ®åº“æ“ä½œ
- è§†å›¾æŸ¥è¯¢
```

### åœºæ™¯æµ‹è¯•
```
- ä¹…åä¸Šç­æ—åœºæ™¯
- ä¸­å¹´äººåœºæ™¯
- è€å¹´äººåœºæ™¯
- å­•æœŸå¥³æ€§åœºæ™¯
- åº·å¤æœŸæ‚£è€…åœºæ™¯
- ç‰¹æ®Šç–¾ç—…åœºæ™¯
```

---

## ğŸ“‹ éƒ¨ç½²æ¸…å•

- [ ] æ•°æ®åº“è¿ç§»è„šæœ¬æ‰§è¡Œ
- [ ] è¡¨ç»“æ„éªŒè¯
- [ ] è§†å›¾åˆ›å»ºéªŒè¯
- [ ] æ ‡å‡†æ•°æ®æ’å…¥éªŒè¯
- [ ] API ç«¯ç‚¹æµ‹è¯•
- [ ] å‰ç«¯é›†æˆæµ‹è¯•
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•
- [ ] å®‰å…¨å®¡è®¡
- [ ] æ–‡æ¡£å®Œå–„
- [ ] ç”¨æˆ·åŸ¹è®­

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `PERSONALIZED_HEALTH_API.md` - API è¯¦ç»†æ–‡æ¡£
- `DEPLOYMENT_GUIDE.md` - éƒ¨ç½²æŒ‡å—
- `FRONTEND_INTEGRATION_GUIDE.md` - å‰ç«¯é›†æˆ
- `IMPLEMENTATION_SUMMARY.md` - å®ç°æ€»ç»“

---

**ç‰ˆæœ¬**: 1.0
**æœ€åæ›´æ–°**: 2026-01-05
**ç»´æŠ¤è€…**: HealthTrack å›¢é˜Ÿ
